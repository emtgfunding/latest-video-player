<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Latest Video</title>
  <style>
    body, html { margin:0; height:100%; background:#000; }
    video { width:100%; height:100%; object-fit:contain; }
  </style>
</head>
<body>
  <video
    id="player"
    autoplay
    muted
    playsinline
    controls
  >
    <source
      id="source"
      src="https://shotstack-api-v1-output.s3-ap-southeast-2.amazonaws.com/htkh67dmtu/f47f4c08-0e77-4fad-9156-b5d2b2e69952.mp4"
      type="video/mp4"
    >
    Your browser doesnâ€™t support HTML5 video.
  </video>

  <script>
    // 1) Autoplay muted then unmute after 1s
    window.addEventListener('load', () => {
      const v = document.getElementById('player');
      v.play().catch(()=>{});
      setTimeout(() => {
        v.muted = false;
        v.volume = 1.0;
        v.play().catch(()=>{});
      }, 1000);
    });

    // 2) Watch for changes in the <source> src attribute on the server
    let currentSrc = document.getElementById('source').getAttribute('src');

    async function checkForNewSource() {
      try {
        // Fetch the raw HTML of this page (avoiding cache)
        const res = await fetch(window.location.pathname + '?_=' + Date.now(), { cache: 'no-store' });
        const text = await res.text();
        // Extract the first occurrence of src="...mp4"
        const match = text.match(/<source\s+[^>]*id="source"[^>]*src="([^"]+)"/i);
        if (match && match[1] !== currentSrc) {
          location.reload();
        }
      } catch (e) {
        console.error('Error checking for new source:', e);
      }
    }

    // Check first after 5s, then every 10s
    setTimeout(checkForNewSource, 5000);
    setInterval(checkForNewSource, 10000);
  </script>
</body>
</html>


